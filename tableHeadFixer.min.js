/*!
TableHeadFixer plugin for JQuery
Version 1.1.0
Copyright (C) 2016 Lai Xuancheng <lai32690@gmail.com>
License MIT
*/
(function($,window){$.fn.tableHeadFixer=function(f){var i={head:true,foot:false,left:0,right:0,"z-index":0};var g=$.extend({},i,f);return this.each(function(){g.table=this;g.parent=$(this).parent();k();if(g.head==true){c()}if(g.foot==true){h()}if(g.left>0){m()}if(g.right>0){a()}j();$(g.parent).trigger("scroll");$(window).resize(function(){$(g.parent).trigger("scroll")})});function j(){var q=null;var p;if(g.head){if(g.left>0||g.right>0){p=$(g.table).find("thead tr");if(p.length>0){q=$();if(g.left>0){p.each(function(s,t){l(t,function(u){q=q.add(u)})})}if(g.right>0){p.each(function(s,t){d(t,function(u){q=q.add(u)})})}}}}if(g.foot){if(g.left>0||g.right>0){p=$(g.table).find("tfoot tr");if(p.length>0){if(!q){q=$()}if(g.left>0){p.each(function(s,t){l(t,function(u){q=q.add(u)})})}if(g.right>0){p.each(function(s,t){d(t,function(u){q=q.add(u)})})}}}}if(q&&q.length>0){var o=$('<div style="background:none;display:none;"/>').appendTo($(g.parent));var r=o.css("background-color");o.remove();q.each(function(t,s){e(s,r)}).css("z-index",g["z-index"]+1)}}function e(o,r){for(var q=o;q!=null;q=q.parentElement){var p=$(q).css("background-color");if(p&&p!==r){if(q!=o){$(o).css("background-color",p)}return}}$(o).css("background-color","#FFF")}function k(){var o=$(g.parent);var p=$(g.table);o.append(p).css({overflow:"auto","overflow-x":"auto","overflow-y":"auto"}).scroll(function(){var s=g.parent;var t=s.scrollWidth;var w=s.clientWidth;var y=s.scrollHeight;var u=s.clientHeight;var v=o.scrollTop();var q=y-u-v;var r=o.scrollLeft();var x=t-w-r;if(g.head){this.find("thead tr > *").css("top",v)}if(g.left>0){g.leftColumns.css("left",r)}if(g.right>0){g.rightColumns.css("right",x)}if(g.foot){this.find("tfoot tr > *").css("bottom",q)}}.bind(p))}function c(){var o=$(g.table).find("thead tr > *");o.css("position","relative")}function h(){var o=$(g.table).find("tfoot tr > *");o.css("position","relative")}function m(){var p=$(g.table).find("tr");var o=$();p.each(function(q,s){l(s,function(r){o=o.add(r)})});if(o.length>0){o.css("position","relative");g.leftColumns=o}}function a(){var p=$(g.table).find("tr");var o=$();p.each(function(q,s){d(s,function(r){o=o.add(r)})});if(o.length>0){o.css("position","relative");g.rightColumns=o}}function l(u,s){var p=g.left;var t=1;for(var q=1;q<=p;q=q+t){var r=t>1?q-1:q;var o=$(u).find("> *:nth-child("+r+")");var v=o.prop("colspan");if(n(o).left<p){s(o)}t=v}}function d(u,s){var p=g.right;var t=1;for(var q=1;q<=p;q=q+t){var r=t>1?q-1:q;var o=$(u).find("> *:nth-last-child("+r+")");var v=o.prop("colspan");s(o);t=v}}function n(r,o){var q=r.data("cellPos");if(!q||o){var p=r.closest("table, thead, tbody, tfoot");b(p);q=r.data("cellPos")}return q}function b(p){var o=[];p.children("tr").each(function(r,q){$(q).children("td, th").each(function(u,t){var z=$(t),w=z.attr("colspan")|0,y=z.attr("rowspan")|0,v,s;w=w?w:1;y=y?y:1;for(;o[r]&&o[r][u];++u){}for(v=u;v<u+w;++v){for(s=r;s<r+y;++s){if(!o[s]){o[s]=[]}o[s][v]=true}}var A={top:r,left:u};z.data("cellPos",A)})})}}})(jQuery,window);